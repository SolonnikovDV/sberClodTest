## Валидация данных

### Варианты валидации:
* по источнику данных
* по ожидаемому типу данных
* по наличию эканируемых символов
* ```NULL``` объекты
* на соответствие шаблону (например ```'dd-mm-YYYY H24:MI:SS UTC'```)
* на ограничения принмаемых данными значений 
* на макросы

### Настройка валидации
* на этапе проектирования:
  * изучение источника данных (API, eternal/external storage, local generated info, ftp, etc...), на предмет в каком виде выдаются данные, наличие/отсутствие необходимости предподготовки данных
  * тип конвейра извлечения данных (ELT, ETL), для понимания на каком этапе выполнять валидацию
* где выполнять валидацию на backend или в БД
* что делать с данными, не прошедшими проверку (правила)

### Инструменты валидации:
* набор правил - проектирование набора правил, готовится для известных типов данных (т.е. мы хорошо знаем сточник и понимаем что к нам приходит)
  * правила неизменяемые (встроенные) - относятся чаще к типам
  * правила пользовательские - ограничения наложенные бизнесом к объему данных (например часть данных, получаемых через API, не используется никогда, но фактически занимает место)
  * правила условные - параметры бизнес планирования
* обработка ```NULL``` объектов - такие объекты могут говорить как о неполноте получаемых данных (необходима оценка бизнесом о необходимости таких источников), либо о проблемах с извлечением данных ("кривое API")
* проверка контрольных сумм излекаемых и загруженных данных

### Процесс валидации
* извлекаемые данные парсятся на предмет проверки типов данных
* если тип данных отличается от ожидаемого, выполняется приведение к нужному типу
* если приведение к нужному типу не происходит, такое исключение оброабатывается, а объект, не прошедший валидацю, утилищируется по заданному правилу (удаление, загрузка с пометкой, загрузка в батч с невалидными данными и тд)
* данные прошедшие валидацию транспортируются в очищеный слой
* см. проблемный сценарий

### Какие могут быть проблемы
* плохо изученный источник генерирует данные, которые образом проходят проверку валидатора, но могут вызвать исключения и завершение программы
* данные намерянно "замаскированы" под ожидаемый тип (пользовательский класс)

### Как решать такие проблемы
* предусмотреть на backend обработку исключений, связанных с траспортом данных
* тестирование загруженных и прошедших валидаторы данных по сценариям (сценарий - объем операций предусморенных для данных, выборки, использование в приложениях, визуализация и т.д.)
  * загрузка данных на тестовый стенд
  * проверка по сценариям, 
  * обработка исключений в процессе сценарного тестирования, 
  * утилизация невалидных данных 
  * загрузка валидных данных на реплику
  * траспорт  с реплики в очищенный слой данных